<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

    <meta name="description" content="Software development using .NET, C#, SQL, Javascript and related technologies" />

    <title>TDD: the bad parts | Mikhail Shilkov</title>
    <meta name="author" content="Mikhail Shilkov">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/feed/" rel="alternate" title="mikhail.io" type="application/atom+xml">
    <link href="/favicon.ico?v=2" rel="shortcut icon">

    <!-- Bootstrap -->
    <link href="/styles/site.css" rel="stylesheet" media="screen">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/scripts/vendor/html5shiv.js"></script>
    <script src="/scripts/vendor/respond.min.js"></script>
    <![endif]-->

    <meta name="generator" content="DocPad v6.78.4" />
    
</head>
<body>

<div class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">
                <span class="text-primary">Mikhail Shilkov</span><br />
                <span class="elevator-pitch">.NET, SQL and Javascript programmer</span>
            </a>
        </div>
        <div class="collapse navbar-collapse navbar-right">
            <ul class="nav navbar-nav">
                <!--<li><a href="/">Blog</a></li>-->
                
                <li><a href="/">Blog</a></li>
                <li><a href="/about">About</a></li>
                <li class="hidden-xs">
                    <a href="/feed/" class="rss"><span class="icon icon-feed"></span></a>
                    <a href="https://www.linkedin.com/in/mikhailshilkov" class="linkedin"><span class="icon icon-linkedin"></span></a>
                    <a href="http://twitter.com/mikhailshilkov" class="twitter"><span class="icon icon-twitter"></span></a>
                    <a href="https://github.com/mikhailshilkov" class="github"><span class="icon icon-github"></span></a>
                </li>
            </ul>
            <form class="navbar-form navbar-right hidden-xs" role="search" action="http://google.com/search"
                  method="get">
                <div class="form-group">
                    <input type="search" name="q" class="form-control" placeholder="Search">
                    <input type="hidden" name="q" value="site:mikhail.io">
                </div>
            </form>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-sm-12 col-md-10">
            <article class="post">
    <div class="post-date">Feb 4th, 2016</div>
    
    <h1>TDD: the bad parts</h1>
    
    <div class="post-content">
        <p>About a year ago we (the host team) agreed to use TDD for the new code that we develop.
Since then, we have a constant debate between TDD adopters (Bjorn still being
the only consistent adopter) and everyone else, who use TDD from &quot;sometimes&quot; to
&quot;never&quot;. Nobody benefits from this status-quo, so I want to discuss it one
more time. Here is my point of view.</p>
<h2 id="what-and-why-">What and why </h2>
<p>TDD is Test-Driven Development - a technique when a developers starts with
tests before writing any line of code.</p>
<p>Here are the three reasons why I voted for TDD adoption:</p>
<ul>
<li>To create the automated test suit which would work to prevent the regression
bugs in existing code base when changes are introduced</li>
<li>To improve the design of the codebase - to force the SOLID principles,
small classes and methods, etc</li>
<li>To provide a rapid feedback during development (as opposed to debugger driven
development)</li>
</ul>
<p>These goals are still totally valid to me, and TDD is <strong>one of the tools to achieve that</strong>.
But 
a) There might be other ways to achieve these goals in some cases
b) If in some cases, TDD does not help with these goals, it should not be used</p>
<h2 id="our-tdd">Our TDD</h2>
<p>Now, TDD in general does not immediately say a lot about the exact way to
execute it; there are several ways to do that. Similarly, there several flavours
of the code that we write, and they have different properties. </p>
<p>At the same time, in our team some TDD rules are very specific and prescriptive:</p>
<ul>
<li>We only write unit tests (we acknoledge the theoratical benefit of integration
tests, but usually we don&#39;t write them regularly)</li>
<li>Unit test should only touch one class, all dependencies should be mocked out</li>
<li>DI is also part of TDD, so all the dependencies are accepted as constructor 
arguments; nothing else can be a constructor argument; there can be just one 
constuctor</li>
<li>Static methods are not acceptable</li>
<li>These rules apply to all the code that we write</li>
</ul>
<p>I have some problems with this setup (each problem maps to a goal mentioned above):</p>
<ul>
<li>For some code unit tests won&#39;t help testing that code works</li>
<li>Some design decisions needed for our flavour of TDD induce damage to code
design</li>
<li>TDD is not always the most natural way to develop code</li>
</ul>
<p>Let&#39;s start with the last one.</p>
<h2 id="tdd-is-not-always-a-pleasant-and-productive-flow">TDD is not always a pleasant and productive flow</h2>
<p>This is subjective to large extend, but there are objective issues too. 
Sometimes, you need to work in exploration mode, creating and erasing the code
several times before you arrive to something decent. You will be creating
and erasing the tests too. Sometimes you start with existing code from somewhere
and need to try it to evaluate. Sometimes too much effort is needed to create
a &quot;pure&quot; unit test.</p>
<p>By itself, this argument is usually related to lack of professionalism which
is IMO an oversimplification.</p>
<h2 id="not-all-unit-tests-are-equally-useful">Not all unit tests are equally useful</h2>
<p>The most useful unit tests can be formulated in terms of requirements, not
implementation. For some code it&#39;s not always easy or possible. Some examples:</p>
<ul>
<li><p>Code which calls external services, e.g. sends messages to the queue. We
can mock up all the queue classes and check the calls one by one, but does
it guarantee that sending to the queue will work? Nope.</p>
</li>
<li><p>Configuration code of different kind has same problem. Making sure that
unit test repeats all the steps from the implementation doesn&#39;t prove the
configuration is correctly wired up.</p>
</li>
</ul>
<p>Integration tests could be better in these scenarios.</p>
<h2 id="test-induced-design-damage">Test-induced design damage</h2>

    </div>

    
    <p>
      Like this post? Please share it!<br />
      <table>
        <tr>
          <td>
            <a href="https://twitter.com/share" class="twitter-share-button" data-via="MikhailShilkov">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
          </td>
          <td>
            <a href="http://news.ycombinator.com/submit" class="hn-share-button" style="height: 28px">Vote on HN</a>
            <script src="//hnbutton.appspot.com/static/hn.min.js" async defer></script>
          </td>
          <td style="vertical-align: top; padding-top: 3px">
            <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent(window.location); return false"> <img src="//www.redditstatic.com/spreddit7.gif" alt="submit to reddit" border="0" width="75" /> </a>
          </td>
        </tr>
      </table>
    </p>

    See a mistake? <a href="https://github.com/mikhailshilkov/mikhailio-docpad/edit/master/src/documents/neverfinished/tdd/index.html.md">Edit this post!</a><br />
    

    
    <div class="post-tags">
        Posted In: <a href='/tags//'></a>
    </div>
    
</article>
            <div id="me">
    <p itemscope itemtype="http://data-vocabulary.org/Person">
        <img src="/images/Headshot-Square.jpg" alt="Mikhail Shilkov" itemprop="photo" />
        I'm <b><span itemprop="name">Mikhail Shilkov</span></b>, a <span itemprop="title">software developer</span>. I enjoy C#, Javascript and SQL development and I blog about my experience on this website.
    </p>
    <p>
        <a href="https://www.linkedin.com/in/mikhailshilkov/">LinkedIn</a> &#8226;
        <a href="http://twitter.com/mikhailshilkov">@mikhailshilkov</a> &#8226;
        <a href="https://github.com/mikhailshilkov">GitHub</a> &#8226;
        <a href="http://stackoverflow.com/users/1171619/mikhail">Stack Overflow</a>
    </p>
</div>

            <div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript></div>
<script type="text/javascript">
    var disqus_shortname = 'mikhailio';
    var disqus_url = 'http://mikhail.io/neverfinished/tdd';
    var disqus_identifier = disqus_url;
    var disqus_title = 'TDD: the bad parts';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

        </div>
    </div>
</div>
<div class="container">
    <div class="navbar navbar-footer">
        <p class="navbar-center navbar-text">Content copyright &copy; 2016 Mikhail Shilkov</p>
    </div>
</div>



<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<script src="/vendor/highlight.pack.js"></script>
<script src="/site.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59218480-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>